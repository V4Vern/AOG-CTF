#include  <stdio.h>
#include  <stdlib.h>

void print_flag()
{
	char flag[64];
	FILE *f = fopen("flag.txt","r");
	if (f == NULL) {
		printf("Flag File is Missing.\n");
		exit(0);
	}
	fgets(flag,sizeof(flag),f);
	printf("%s\n", flag);
}


int main(void)
{
	unsigned char buffer[5];

	setvbuf(stdin,NULL,2,0);
	setvbuf(stdout,NULL,2,0);
	setvbuf(stderr,NULL,2,0);

	printf("Give me the location of our buffer (%p)\n", buffer);
	printf("Type in the hex for each byte\n");
	for(int i=0;i<4;i++) {
		printf("Byte %d: ", i+1);
		scanf("%02hhX", buffer+i);
	}
	buffer[4] = 0;

	unsigned int buffer_loc = (unsigned int) buffer;
	unsigned int check = *(unsigned int *) buffer;

	printf("The buffer is at 0x%x\n", buffer_loc);
	printf("You gave 0x%x\n", check);

	if (check == buffer_loc) {
		printf("You got it!\n");
		print_flag();
	} else {
		printf("Nope.\n");
	}

	return 0;
}