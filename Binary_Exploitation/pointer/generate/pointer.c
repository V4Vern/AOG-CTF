#include <stdio.h>
#include <stdlib.h>
#include <string.h>

char flag[64];
char *password = "Int3rest1ng";
char *success = "Password accepted. Welcome.";
char *failure = "Intruder detected! Get him!";

int main(int argc, char** argv) {
	char* target;
	char buffer[32] = {0x00};
	FILE *f;

	setvbuf(stdin,NULL,2,0);
	setvbuf(stdout,NULL,2,0);
	setvbuf(stderr,NULL,2,0);

	// Set up flag
	f = fopen("flag.txt","r");
	if (f == NULL) {
		printf("Flag File is Missing.\n");
		exit(0);
	}
	fgets(flag,sizeof(flag),f);

	printf("[HELPER] target is located at %p and buffer is located at %p\n\n", &target, &buffer);

	target = failure;
	printf("Welcome to my secret base. What's the password?\n");
	fgets(buffer, 0x30, stdin);

	if (strcmp(buffer, password) == 0) {
		target = success;
	}

	printf("%s\n", target);
}