#include <stdio.h>
#include <string.h>
#include <stdlib.h>

#define FLAGSIZE 64

char flag[FLAGSIZE];

void win(){
	FILE *f = fopen("flag.txt","r");
	if (f == NULL) {
		printf("Flag File is Missing.\n");
		exit(0);
	}

	fgets(flag,FLAGSIZE,f);
	printf(flag);

	return;
}


void vulnerable() {
	volatile long val = 0x12345678;
	char buf[64] = {0x00};

	printf("The flag can only be touched when val is altered, you can never figure it out!\n");
	fgets(buf, 69, stdin);
	
	printf("buf: %s\n",buf);
    printf("val: 0x%08x\n",val);

	if (val == 0xdeadbeef)
		win();
	else {
		printf("Nope.");
		exit(1);
	}
	return;	
}

int main() {
	setvbuf(stdout, NULL, _IONBF, 0);
	vulnerable();
	return 0;
}