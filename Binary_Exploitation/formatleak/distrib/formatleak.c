#include <stdio.h>
#include <string.h>
#include <stdlib.h>

#define FLAGSIZE 64

void vulnerable() {
	char buffer[128] = {0x00};
	char flag[FLAGSIZE] = {0x00};

	// Reading flag file
	FILE *f = fopen("flag.txt","r");
	
	if (f == NULL) {
		printf("Flag File is Missing.\n");
		exit(0);
	}

	fgets(flag,FLAGSIZE,f);

	// start of vulnerability
	printf("Printf is cool and all but what happens when you just send a format string such as %%x?\n");
	printf("Look out for the hex of 19C4\n");

	fgets(buffer, sizeof(buffer), stdin);
	printf(buffer); // this is the vulnerablility
}	

int main(){
	setvbuf(stdout, NULL, _IONBF, 0);

	vulnerable();
}