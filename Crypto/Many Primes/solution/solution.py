from factordb.factordb import FactorDB
from Crypto.Util.number import long_to_bytes
import gmpy2

f = FactorDB(
    580642391898843192929563856870897799650883152718761762932292482252152591279871421569162037190419036435041797739880389529593674485555792234900969402019055601781662044515999210032698275981631376651117318677368742867687180140048715627160641771118040372573575479330830092989800730105573700557717146251860588802509310534792310748898504394966263819959963273509119791037525504422606634640173277598774814099540555569257179715908642917355365791447508751401889724095964924513196281345665480688029639999472649549163147599540142367575413885729653166517595719991872223011969856259344396899748662101941230745601719730556631637)
f.connect()
N = 0x12d700ac4ac21a79e604f1e2efbedb5978911dbf7af54efc2dd99093f010e7c162540e8b8a51a82afc6990d46d1ae8e3bd32438c2cfbc021917b62bdb69d4e4377344ebc30b344145cbb32494c7a0d1ca373a6a7840dcf9a902c2cbd7ddefce124bccdfedee89be6ed8db2325517bac80bb85553f69928b1b9f222fb3c15f13dccef21d95084f2924d1f3beb79eb677288b4bd17bdbbef62b2688ddb3caa46769bdc5ed50c2618b46dc1fb58e095d3bf91046a79726976ce7a479fbfe931b53178edf08bc792a6d123535670aa28958849a4218c6bf2d8976ae3450e7302304363e80f628eaf5df400cbb7d77e8d6732ceb129f69e783d9a24b2a24effa55
e = 0x10001
c = 0xa0fc7607de88236acd0960e38e14b7ab79944686845a5a1bd7be5d9d6d9f95e2a0b3e76350121611fdca4c0c5dc8037df0a74addc10010f9b4de4526b8e658771163ebedc3f7a729f3c5ec60ac009ecd9aa141481899a8a541488303c236a0d81865f59cfc1b8c41ca24e197c011abbf9ab12686454ae7940175c9a00042baf3d969f54d9ef4d5c018c179ddf7455a7b3ef601de052fdf3d827b1125ffad6098483224093bbb1364f594b4d5a95e0fdce3fea8b768164ad2f286f443ac58bcd108ccd7923eb4e2221ca963258f0f3e7b346a84da2cfe91dbd02f6788004fd9a1c7e6b75b96889784176e0687255c8994a96c8f5e6f024c68cae1e4a59c65

phi = 1

for prime_numbers in f.get_factor_list():
    phi *= prime_numbers - 1

d = gmpy2.invert(e, phi)

plaintext = pow(c, d, N)
decrypted = long_to_bytes(plaintext)
print(decrypted)
